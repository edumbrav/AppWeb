import React from 'react'
 
import { Link } from 'react-router-dom';
import moment from 'moment';

import DatePicker from "react-datepicker";
import "react-datepicker/dist/react-datepicker.css";
import {RoomContext} from '../context/RoomProvider'
export const habitacionContext=React.createContext()
 



const Booknow2 =( )=>{    
    const{room,cambioRoom}=React.useContext(RoomContext)


    const [checkInDate, setCheckInDate] =React.useState(null);
    const [checkOutDate, setCheckOutDate] =React.useState(null);
    const [total,setTotal]=React.useState();

    const [dias,setDias]= React.useState(1);
 

   

      const timeCalc = (checkInDate, checkOutDate) => {
        try {
        if(checkInDate===null || checkOutDate===null){
            return 0
        }
        const start = moment(checkInDate)
        const end = moment(checkOutDate)
        const days=end.diff(start, "days", true)
        
        return days
      }catch(error) {
        console.log(error)
      }
    }
      
    const updateThisData=( )=>{
        
        try {
     
             
            setDias(timeCalc(checkInDate,checkOutDate))
            setTotal(dias*room.precio)
            console.log("CGGG",checkInDate)
            console.log("ooouu",checkOutDate)
            console.log("DIAS",dias)
            console.log("TOTAL",total)
        } catch (error) {
            
        }

    
    }
    
    const reserveRoom=()=>{
//crear un id que se agregue en una nueva colecion que diga reservas, dentro o fuera del usuario
//si es dentro del usuario generar un mapa con las reservas y mostrar todas en el nav reservas 


    }


    return(
      
    
       
       
    
        <div className="container col-md-10 col-6 mx-auto mt-5 p-5">
            <div className="row  mt-10">
                <div className="col-md-10 mx-auto col-12 card shadow-lg border-0 p-4  mt-10">
                    <div>
                        <h1 className="display-4  mt-10">Registro</h1>
                    </div>
                    <div className="row">
                        <div className="col-md-6 col-12 my-auto">
                            <img src={room.imagen} className="img-fluid" alt="selected room" />
                        </div>
                        <div className="col-md-6 col-12 my-auto">
                            <h1>Detalles de habitación</h1>
                            <table className="table">
                                <thead className="thead-light">
                                    <tr>
                                        <th>ID room</th>
                                        <td>{room.nombre}</td>
                                    </tr>
                                    <tr>
                                        <th>Capacidad</th>
                                        <td>este numero es dado por la base de datos</td>
                                    </tr>
 
                                    <tr>
                                        <th>Desayuno</th>
                                        <td> Desayuno gratis incluido</td>
                                    </tr>
                                    <tr>
                                        <th>Mascotas </th>
                                        <td> No se admite</td>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                    <div className="row my-3">
                        <div className="col-md-6 col-12">
                            <div className="form-group">
                                <label htmlFor="Fromdate" className="font-weight-bolder mr-3">Desde : </label>
                                <DatePicker
                                selected={checkInDate}
                                minDate={new Date()}
                                onChange={date=>setCheckInDate(date)}
                                className="form-control  " 
                                placeholderText="Fecha de inicio"
                                dateFormat="MMMM d, yyyy" />
                                
                            </div>
                    
                        </div>
                        <div className="col-md-6 col-12">
                            <div className="form-group">
                                <label htmlFor="Todate" className="font-weight-bolder mr-3">Hasta :    </label>
                                <DatePicker 
                                selected={checkOutDate}
                                minDate={checkInDate}
                                onChange={date=>setCheckOutDate(date)}
                              

                                
                                placeholderText="Fecha Fin"   
                                className="form-control" 
                                dateFormat="MMMM d, yyyy" />
 

 

                            </div>
                        </div>
                    </div>
                   
                    {checkInDate && checkOutDate && (
                      
                         
                            <div className="summary">
                            <p>
                            <mark> Usted reserva la habitación desde {moment(checkInDate, 'YYYY-MM-DD').format("LL")} hasta{" "}
                                {moment(checkOutDate, 'YYYY-MM-DD').format("LL")}. </mark>
                                
                            </p>
                            </div>
                            
                        )}
                    <div className="row p-2">
                        <div className="col-md-6 col-12 my-4">
                            <h6 className="font-weight-bolder">Días de reserva: {timeCalc(checkInDate, checkOutDate)}</h6>
                            <mark>Por favor, asegurese de realizar su registro entre las 9 am y 12 pm</mark>
                            
                        </div>
                        <div className="col-md-6 col-12 my-4 ">
                            <h6 className="font-weight-bold">Precio por día : <span className="text-primary">${room.precio}</span>  </h6>
                           
                            <h6 className="font-weight-bold">Total Price to be paid : <span className="text-primary">${timeCalc(checkInDate, checkOutDate)*room.precio}</span></h6>
                        </div>
                    </div>
                    <div className="row my-3">
                        <div className="col-md-6 col-12">
                            <div className="form-group">
                                <label htmlFor="payment" className="font-weight-bolder mb-1">Opciones de pago</label>
                                <select className="form-control">
                                    <option disabled>Seleccione método de pago </option>
                                    <option value="Credit">Credito</option>
                                    <option value="Debit">Debito</option>
                                    <option value="checkin">Pagar en el checking</option>
                                </select>
                            </div>
                        </div>
                        
                        <div className="col-md-6 col-12 my-4 ">
                            <div className="col-md-6 col-12 float-right my-1 px-4">
                                <button className="btn btn-block btn-outline-primary " 
                                data-toggle="modal" 
                                data-target="#thanks"
                                onClick={() =>{
                                    timeCalc(checkInDate,checkOutDate);
                                    updateThisData();}}
                                
                                >Confirmar Registro</button>
                            </div>
                          
                        </div>
                    </div>
                </div>
            </div>
            <div className="modal fade" id="thanks">
                <div className="modal-dialog modal-dialog-centered">
                    <div className="modal-content">
                        <div className="modal-body p-4">
                            <h3>Gracias! </h3>
                            <p className="lead">Su habitación ha sido registrada con éxito!....</p>
                        </div>
                        <div className="modal-footer">
                            <Link to="/" className="btn btn-dark">Ir al inicio</Link>
                            <button type="button" className="btn btn-secondary" data-dismiss="modal">Close</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
     
    )  


}
export default   Booknow2